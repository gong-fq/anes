<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnesLink麻醉助手</title>
    <style>
        /* 重置和基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* 顶部导航栏 */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo h1 {
            color: #1a237e;
            font-size: 24px;
            font-weight: 600;
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #555;
            font-weight: 500;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .nav-links a:hover,
        .nav-links a.active {
            background: #1a237e;
            color: white;
        }
        
        /* 主容器 */
        .main-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        /* 头部横幅 */
        .header-banner {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .header-banner h2 {
            color: #1a237e;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header-banner .subtitle {
            color: #666;
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* AI助手主区域 */
        .ai-assistant-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 992px) {
            .ai-assistant-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* 左侧功能简介 */
        .intro-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }
        
        .intro-card h3 {
            color: #1a237e;
            margin-bottom: 20px;
            font-size: 22px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8eaf6;
        }
        
        .intro-content {
            font-size: 16px;
            color: #555;
            line-height: 1.8;
        }
        
        .feature-list {
            list-style: none;
            margin-top: 20px;
        }
        
        .feature-list li {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
        }
        
        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
        }
        
        /* 聊天主区域 */
        .chat-main {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        
        /* 聊天消息区域 */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: #f8f9fa;
        }
        
        .message {
            margin-bottom: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.assistant {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #1a237e;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .message.user {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #2196f3;
            margin-left: auto;
            max-width: 80%;
        }
        
        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            color: #1a237e;
            font-weight: 600;
            font-size: 16px;
        }
        
        .message-header i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .message-content {
            line-height: 1.7;
            white-space: pre-line;
            color: #444;
        }
        
        /* TTS控制区域 - 修复的重点 */
        .tts-controls {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .tts-btn, .tts-stop-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            background: #1a237e;
            color: white;
            cursor: pointer;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .tts-btn:hover {
            background: #283593;
            transform: translateY(-1px);
        }
        
        .tts-btn.playing {
            background: #4caf50;
        }
        
        .tts-stop-btn {
            background: #f44336;
            display: none;
        }
        
        .tts-stop-btn:hover {
            background: #d32f2f;
        }
        
        .tts-lang-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            font-size: 14px;
            min-width: 140px;
        }
        
        /* 输入区域 */
        .input-container {
            padding: 25px;
            background: white;
            border-top: 1px solid #e8eaf6;
        }
        
        .input-wrapper {
            display: flex;
            gap: 15px;
        }
        
        #message-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        #message-input:focus {
            outline: none;
            border-color: #1a237e;
        }
        
        #send-btn {
            padding: 16px 32px;
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        #send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.3);
        }
        
        #send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* 提示文本 */
        .hint-text {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 15px;
            font-style: italic;
        }
        
        /* 底部信息 */
        .footer {
            text-align: center;
            padding: 30px;
            color: white;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-top: 40px;
        }
        
        .footer a {
            color: #bbdefb;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .disclaimer {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 13px;
        }
        
        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #1a237e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                gap: 15px;
            }
            
            .header-banner h2 {
                font-size: 24px;
            }
            
            .ai-assistant-container {
                gap: 20px;
            }
            
            .chat-main {
                height: 500px;
            }
            
            .tts-controls {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .input-wrapper {
                flex-direction: column;
            }
            
            #send-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
    <!-- Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-stethoscope" style="color: #1a237e; font-size: 28px;"></i>
                <h1>AnesLink麻醉助手</h1>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="active">首页</a></li>
                <li><a href="#">医学资料库</a></li>
                <li><a href="#">随访提醒</a></li>
            </ul>
        </div>
    </nav>

    <!-- 主内容区 -->
    <div class="main-container">
        <!-- 头部横幅 -->
        <div class="header-banner">
            <h2>AnesLink AI助手 <span class="badge">基于DeepSeek</span></h2>
            <p class="subtitle">专为麻醉科医生设计的智能助手</p>
        </div>

        <!-- AI助手主区域 -->
        <div class="ai-assistant-container">
            <!-- 左侧功能简介 -->
            <div class="intro-card">
                <h3>AI助手</h3>
                <div class="intro-content">
                    <p><strong>您好！我是AnesLink AI助手</strong></p>
                    <p>基于DeepSeek技术构建，可以为您提供：</p>
                    <ul class="feature-list">
                        <li>麻醉药物信息：剂量、适应症、不良反应</li>
                        <li>麻醉技术指导：操作流程、注意事项</li>
                        <li>并发症处理：预防策略、紧急处理方案</li>
                        <li>术前评估：风险评估、准备工作</li>
                        <li>术后管理：镇痛方案、随访建议</li>
                    </ul>
                    <p style="margin-top: 20px; color: #666; font-size: 14px;">
                        请输入您的问题，我会为您提供专业的麻醉学建议。
                    </p>
                </div>
            </div>

            <!-- 右侧聊天区域 -->
            <div class="chat-main">
                <!-- 聊天消息区域 -->
                <div id="chat-messages" class="chat-messages">
                    <!-- 初始欢迎消息 -->
                    <div class="message assistant">
                        <div class="message-header">
                            <i class="fas fa-robot"></i>
                            AnesLink AI助手
                        </div>
                        <div class="message-content">
                            您好！我是AnesLink AI助手，基于DeepSeek技术构建。
                            
                            我可以为您提供专业的麻醉学支持：
                            • 药物剂量查询与计算
                            • 麻醉方案制定指导
                            • 并发症预防与处理
                            • 术前风险评估
                            • 术后管理建议
                            
                            请问有什么可以帮您？
                        </div>
                        <div class="tts-controls">
                            <button class="tts-btn" title="朗读此消息">
                                <i class="fas fa-volume-up"></i> 朗读
                            </button>
                            <button class="tts-stop-btn" title="停止朗读">
                                <i class="fas fa-stop"></i> 停止
                            </button>
                            <select class="tts-lang-select">
                                <option value="zh-CN">中文</option>
                                <option value="en-US">English</option>
                                <option value="en-GB">English (UK)</option>
                            </select>
                            <span>语速: 1.0x</span>
                        </div>
                    </div>
                </div>

                <!-- 输入区域 -->
                <div class="input-container">
                    <div class="input-wrapper">
                        <input 
                            type="text" 
                            id="message-input" 
                            placeholder="请输入您的问题，例如：如何处理困难气道？"
                            autocomplete="off"
                        >
                        <button id="send-btn">
                            <i class="fas fa-paper-plane"></i> 发送
                        </button>
                    </div>
                    <p class="hint-text">
                        例如：丙泊酚的常用剂量是多少？术后恶心呕吐如何预防？
                    </p>
                </div>
            </div>
        </div>

        <!-- 底部信息 -->
        <div class="footer">
            <p>天津医院麻醉科医师 米岚 倾心打造 AnesLink麻醉助手 © 2026 基于DeepSeek大语言模型</p>
            <p>专为麻醉科临床工作设计</p>
            <div class="disclaimer">
                <strong>重要提示：</strong> 本工具仅供参考，不能替代专业医疗判断。临床决策请结合患者具体情况，并参考最新药品说明书和临床指南。
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ========== 全局变量 ==========
        let currentSpeech = null;
        let currentPlayingMessage = null;
        let abortController = null;
        
        // ========== 初始化 ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('AnesLink麻醉助手已启动 - 原始界面修复版');
            
            // 初始焦点
            document.getElementById('message-input').focus();
            
            // 绑定发送按钮事件
            document.getElementById('send-btn').addEventListener('click', sendMessage);
            
            // 绑定回车键发送
            document.getElementById('message-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
            
            // 绑定TTS按钮事件（使用事件委托）
            document.addEventListener('click', handleTTSClick);
        });
        
        // ========== 发送消息 ==========
        async function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            if (!message) return;
            
            // 添加用户消息
            addMessage('user', message, '麻醉医生');
            input.value = '';
            
            // 禁用发送按钮
            const sendBtn = document.getElementById('send-btn');
            const originalHtml = sendBtn.innerHTML;
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 思考中...';
            
            try {
                // 模拟AI响应（实际使用时替换为API调用）
                const response = await getAIResponse(message);
                
                // 添加AI回复
                addMessage('assistant', response, 'AnesLink AI助手');
                
            } catch (error) {
                console.error('请求失败:', error);
                addMessage('assistant', '抱歉，请求失败，请稍后重试。', 'AnesLink AI助手');
            } finally {
                // 恢复发送按钮
                sendBtn.disabled = false;
                sendBtn.innerHTML = originalHtml;
            }
        }
        
        // ========== 添加消息到聊天 ==========
        function addMessage(role, content, sender) {
            const chatMessages = document.getElementById('chat-messages');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            // 消息头部
            const headerDiv = document.createElement('div');
            headerDiv.className = 'message-header';
            headerDiv.innerHTML = `
                <i class="fas ${role === 'user' ? 'fa-user-md' : 'fa-robot'}"></i>
                ${sender}
            `;
            
            // 消息内容
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            
            // 如果是AI消息，添加TTS控制
            if (role === 'assistant') {
                const ttsDiv = document.createElement('div');
                ttsDiv.className = 'tts-controls';
                ttsDiv.innerHTML = `
                    <button class="tts-btn" title="朗读此消息" data-message-id="${Date.now()}">
                        <i class="fas fa-volume-up"></i> 朗读
                    </button>
                    <button class="tts-stop-btn" title="停止朗读">
                        <i class="fas fa-stop"></i> 停止
                    </button>
                    <select class="tts-lang-select">
                        <option value="zh-CN">中文</option>
                        <option value="en-US">English</option>
                        <option value="en-GB">English (UK)</option>
                    </select>
                    <span>语速: 1.0x</span>
                `;
                
                messageDiv.appendChild(headerDiv);
                messageDiv.appendChild(contentDiv);
                messageDiv.appendChild(ttsDiv);
            } else {
                messageDiv.appendChild(headerDiv);
                messageDiv.appendChild(contentDiv);
            }
            
            chatMessages.appendChild(messageDiv);
            
            // 滚动到底部
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // ========== TTS功能修复（核心） ==========
        function handleTTSClick(event) {
            const target = event.target;
            
            // 处理朗读按钮点击
            if (target.classList.contains('tts-btn') || target.closest('.tts-btn')) {
                const ttsBtn = target.classList.contains('tts-btn') ? target : target.closest('.tts-btn');
                playMessageTTS(ttsBtn);
                event.preventDefault();
                event.stopPropagation();
            }
            
            // 处理停止按钮点击
            if (target.classList.contains('tts-stop-btn') || target.closest('.tts-stop-btn')) {
                stopTTS();
                event.preventDefault();
                event.stopPropagation();
            }
        }
        
        function playMessageTTS(ttsButton) {
            // 如果正在播放其他消息，先停止
            if (currentSpeech) {
                stopTTS();
            }
            
            // 找到对应的消息元素
            const messageElement = ttsButton.closest('.message.assistant');
            if (!messageElement) {
                console.error('未找到消息元素');
                return;
            }
            
            // 提取当前消息的文本
            const contentElement = messageElement.querySelector('.message-content');
            if (!contentElement) {
                console.error('未找到消息内容');
                return;
            }
            
            let text = contentElement.textContent || contentElement.innerText;
            
            // 清理文本：移除TTS控制区域的文本
            text = cleanTTSText(text);
            
            if (!text || text.length < 5) {
                alert('未找到可朗读的内容');
                return;
            }
            
            console.log('TTS播放文本:', text.substring(0, 100) + '...');
            
            // 获取语言设置
            const langSelect = messageElement.querySelector('.tts-lang-select');
            const language = langSelect ? langSelect.value : 'zh-CN';
            
            // 更新UI状态
            updateTTSButtons(messageElement, true);
            currentPlayingMessage = messageElement;
            
            // 播放TTS
            playTTS(text, language);
        }
        
        function cleanTTSText(text) {
            if (!text) return '';
            
            // 移除常见的TTS控制文本
            const patterns = [
                /朗读\s*(停止)?\s*(中文|English|English \(UK\))?\s*语速:\s*[\d\.]+x?/gi,
                /Read\s*(Stop)?\s*(Chinese|English)?\s*Speed:\s*[\d\.]+x?/gi,
                /\n\s*(朗读|Read|停止|Stop).*/gi
            ];
            
            patterns.forEach(pattern => {
                text = text.replace(pattern, '');
            });
            
            // 移除多余的空格和换行
            text = text.replace(/\s+/g, ' ').trim();
            
            return text;
        }
        
        function updateTTSButtons(messageElement, isPlaying) {
            // 重置所有按钮状态
            document.querySelectorAll('.tts-btn').forEach(btn => {
                btn.classList.remove('playing');
                const stopBtn = btn.nextElementSibling;
                if (stopBtn && stopBtn.classList.contains('tts-stop-btn')) {
                    stopBtn.style.display = 'none';
                }
                btn.style.display = 'inline-flex';
            });
            
            if (isPlaying && messageElement) {
                const ttsBtn = messageElement.querySelector('.tts-btn');
                const stopBtn = messageElement.querySelector('.tts-stop-btn');
                
                if (ttsBtn) {
                    ttsBtn.classList.add('playing');
                    ttsBtn.style.display = 'none';
                }
                
                if (stopBtn) {
                    stopBtn.style.display = 'inline-flex';
                }
            }
        }
        
        async function playTTS(text, language) {
            try {
                // 清理和限制文本长度
                const cleanText = text.substring(0, 2000).trim();
                
                // 取消之前的请求（如果有）
                if (abortController) {
                    abortController.abort();
                }
                
                // 创建新的AbortController
                abortController = new AbortController();
                const timeoutId = setTimeout(() => {
                    abortController.abort();
                }, 10000); // 10秒超时
                
                // 调用TTS API - 请替换为你的实际API端点
                const response = await fetch('/api/tts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: cleanText,
                        language: language,
                        speed: 1.0
                    }),
                    signal: abortController.signal
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`TTS API错误: ${response.status}`);
                }
                
                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                const audio = new Audio(audioUrl);
                
                currentSpeech = audio;
                
                // 播放结束事件
                audio.onended = function() {
                    console.log('TTS播放完成');
                    stopTTS();
                };
                
                // 播放错误事件
                audio.onerror = function(error) {
                    console.error('音频播放错误:', error);
                    stopTTS();
                    alert('音频播放失败');
                };
                
                // 开始播放
                await audio.play();
                
            } catch (error) {
                console.error('TTS播放失败:', error);
                stopTTS();
                
                if (error.name === 'AbortError') {
                    alert('请求超时，请稍后重试');
                } else {
                    alert('语音播放失败，请检查网络连接');
                }
            }
        }
        
        function stopTTS() {
            if (currentSpeech) {
                currentSpeech.pause();
                currentSpeech.currentTime = 0;
                currentSpeech = null;
            }
            
            if (abortController) {
                abortController.abort();
                abortController = null;
            }
            
            updateTTSButtons(null, false);
            currentPlayingMessage = null;
        }
        
        // ========== 模拟AI响应 ==========
        async function getAIResponse(message) {
            // 模拟网络延迟
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // 根据问题类型返回不同的响应
            const responses = {
                '困难气道': `处理困难气道的标准流程：

### 术前评估（LEMON法则）
1. Look: 观察外观特征
2. Evaluate: 评估甲颏距离、张口度
3. Mallampati: 咽部分级
4. Obstruction: 气道梗阻迹象
5. Neck mobility: 颈部活动度

### 设备准备
• 各种型号喉镜片
• 可视喉镜
• 喉罩（不同尺寸）
• 纤支镜
• 环甲膜切开包

### 处理策略
Plan A: 首次喉镜插管
Plan B: 声门上气道装置
Plan C: 面罩/声门上通气
Plan D: 紧急有创气道

### 核心原则
• 始终优先保证氧合
• 限制喉镜尝试次数（≤3次）
• 及时寻求帮助
• 备好抢救设备

注：具体情况请根据患者实际状况调整。`,
                
                '丙泊酚': `丙泊酚的临床使用指南：

### 常用剂量
【麻醉诱导】
• 健康成人: 1.5-2.5 mg/kg IV
• 老年人 (>65岁): 1-1.5 mg/kg IV  
• 儿童: 2.5-3.5 mg/kg IV

【麻醉维持】
• 静脉输注: 4-12 mg/kg/h
• TCI模式: 效应室浓度 3-6 μg/mL

【镇静剂量】
• ICU镇静: 0.3-4 mg/kg/h
• 手术室外镇静: 0.5-1 mg/kg 单次

### 注意事项
1. 注射痛: 可预注利多卡因20-40mg
2. 循环抑制: 剂量依赖性血压下降
3. 呼吸抑制: 需备好气道管理设备
4. 过敏反应: 罕见但需警惕

### 禁忌症
• 对丙泊酚或大豆/鸡蛋过敏者
• 严重血脂代谢异常
• 颅内压增高者慎用

### 特殊人群
• 肝功能不全: 剂量减少20-30%
• 肾功能不全: 常规剂量
• 肥胖患者: 按理想体重计算

注意：以上为一般指导原则，具体用药需个体化。`,
                
                'default': `您的问题："${message}"

基于我的医学知识库，我为您提供以下专业建议：

### 临床思维框架
1. 风险评估：全面评估患者状况和手术风险
2. 个体化方案：根据具体情况制定麻醉计划
3. 应急预案：提前准备应对可能并发症
4. 团队协作：确保多学科有效沟通

### 关键考虑因素
• 患者年龄、体重、合并症
• 手术类型、时长、体位
• 麻醉药物选择与配伍
• 监测手段与频率
• 术后镇痛与恢复

### 安全提醒
1. 遵循科室规章制度
2. 使用前核对药物信息
3. 持续监测生命体征
4. 记录完整麻醉过程
5. 及时处理异常情况

### 重要声明
本建议仅供参考，临床决策必须结合：
✓ 患者具体病情
✓ 最新临床指南
✓ 可用医疗资源
✓ 医生专业判断

建议在上级医师指导下实施具体方案。`
            };
            
            // 匹配关键词
            for (const [keyword, response] of Object.entries(responses)) {
                if (message.includes(keyword)) {
                    return response;
                }
            }
            
            return responses.default;
        }
    </script>
</body>
</html>